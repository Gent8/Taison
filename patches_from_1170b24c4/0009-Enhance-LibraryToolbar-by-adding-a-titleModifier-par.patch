From de5b8674b191c6b082f824df5c961e0caf1f3a3c Mon Sep 17 00:00:00 2001
From: Gent8 <deboordermounir@gmail.com>
Date: Sun, 19 Oct 2025 14:43:08 +0200
Subject: [PATCH 09/24] Enhance LibraryToolbar by adding a titleModifier
 parameter for customizable title styling. Update LibraryTab to utilize the
 new titleModifier with a menu anchor for improved dropdown functionality.

---
 .../presentation/library/components/LibraryToolbar.kt      | 7 +++++--
 .../main/java/eu/kanade/tachiyomi/ui/library/LibraryTab.kt | 6 ++++--
 2 files changed, 9 insertions(+), 4 deletions(-)

diff --git a/app/src/main/java/eu/kanade/presentation/library/components/LibraryToolbar.kt b/app/src/main/java/eu/kanade/presentation/library/components/LibraryToolbar.kt
index 3bcdd86b6..f11bcb9a7 100644
--- a/app/src/main/java/eu/kanade/presentation/library/components/LibraryToolbar.kt
+++ b/app/src/main/java/eu/kanade/presentation/library/components/LibraryToolbar.kt
@@ -37,6 +37,7 @@ fun LibraryToolbar(
     hasActiveFilters: Boolean,
     selectedCount: Int,
     title: LibraryToolbarTitle,
+    titleModifier: Modifier = Modifier,
     onClickTitle: (() -> Unit)? = null,
     showTitleDropdownIndicator: Boolean = false,
     onClickUnselectAll: () -> Unit,
@@ -58,6 +59,7 @@ fun LibraryToolbar(
     )
     else -> LibraryRegularToolbar(
         title = title,
+        titleModifier = titleModifier,
         hasFilters = hasActiveFilters,
         onClickTitle = onClickTitle,
         showTitleDropdownIndicator = showTitleDropdownIndicator,
@@ -74,6 +76,7 @@ fun LibraryToolbar(
 @Composable
 private fun LibraryRegularToolbar(
     title: LibraryToolbarTitle,
+    titleModifier: Modifier,
     hasFilters: Boolean,
     onClickTitle: (() -> Unit)?,
     showTitleDropdownIndicator: Boolean,
@@ -89,10 +92,10 @@ private fun LibraryRegularToolbar(
     SearchToolbar(
         titleContent = {
             val clickableModifier = onClickTitle?.let {
-                Modifier
+                titleModifier
                     .fillMaxWidth()
                     .clickable(onClick = it)
-            } ?: Modifier.fillMaxWidth()
+            } ?: titleModifier.fillMaxWidth()
 
             Row(
                 modifier = clickableModifier,
diff --git a/app/src/main/java/eu/kanade/tachiyomi/ui/library/LibraryTab.kt b/app/src/main/java/eu/kanade/tachiyomi/ui/library/LibraryTab.kt
index 8ccb66594..c089ad734 100644
--- a/app/src/main/java/eu/kanade/tachiyomi/ui/library/LibraryTab.kt
+++ b/app/src/main/java/eu/kanade/tachiyomi/ui/library/LibraryTab.kt
@@ -9,12 +9,12 @@ import androidx.compose.foundation.layout.padding
 import androidx.compose.material.icons.Icons
 import androidx.compose.material.icons.automirrored.outlined.HelpOutline
 import androidx.compose.material.icons.outlined.Check
-import androidx.compose.material3.DropdownMenu
 import androidx.compose.material3.DropdownMenuItem
 import androidx.compose.material3.Icon
-import androidx.compose.material3.Text
 import androidx.compose.material3.SnackbarHost
 import androidx.compose.material3.SnackbarHostState
+import androidx.compose.material3.Text
+import androidx.compose.material3.menuAnchor
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.LaunchedEffect
 import androidx.compose.runtime.collectAsState
@@ -42,6 +42,7 @@ import eu.kanade.presentation.library.DeleteLibraryMangaDialog
 import eu.kanade.presentation.library.LibrarySettingsDialog
 import eu.kanade.presentation.library.components.LibraryContent
 import eu.kanade.presentation.library.components.LibraryToolbar
+import eu.kanade.presentation.components.DropdownMenu
 import eu.kanade.presentation.manga.components.LibraryBottomActionMenu
 import eu.kanade.presentation.more.onboarding.GETTING_STARTED_URL
 import eu.kanade.presentation.util.Tab
@@ -136,6 +137,7 @@ data object LibraryTab : Tab {
                         hasActiveFilters = state.hasActiveFilters,
                         selectedCount = state.selection.size,
                         title = title,
+                        titleModifier = Modifier.menuAnchor(),
                         onClickTitle = if (categorySelectorEnabled) {
                             { showCategoryMenu = true }
                         } else {
-- 
2.39.5 (Apple Git-154)

